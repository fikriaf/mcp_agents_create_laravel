<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenLaravel Multi-Page - AI Laravel Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');

        * {
            font-family: 'Inter', sans-serif;
        }

        .gradient-bg {
            background: linear-gradient(135deg, #7c3aed 0%, #a855f7 50%, #c084fc 100%);
        }

        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .limit-badge {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.7;
            }
        }

        .page-card {
            transition: all 0.3s ease;
        }

        .page-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(124, 58, 237, 0.2);
        }

        .status-pending {
            color: #94a3b8;
        }

        .status-running {
            color: #a855f7;
            animation: pulse 2s infinite;
        }

        .status-success {
            color: #10b981;
        }

        .status-error {
            color: #ff4757;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .slide-in {
            animation: slideIn 0.5s ease-out;
        }

        .terminal-output {
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            line-height: 1.5;
        }

        .progress-bar {
            transition: width 0.5s ease;
        }

        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #1e293b;
        }

        ::-webkit-scrollbar-thumb {
            background: #7c3aed;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #a855f7;
        }

        /* Toast Notifications */
        .toast {
            animation: slideInRight 0.3s ease-out;
            min-width: 300px;
            max-width: 400px;
        }

        .toast.removing {
            animation: slideOutRight 0.3s ease-out;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideOutRight {
            from {
                opacity: 1;
                transform: translateX(0);
            }

            to {
                opacity: 0;
                transform: translateX(100%);
            }
        }
    </style>
</head>

<body class="bg-gray-50">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="p-1">
                        <img src="/frontend/multi/GenLaravel.png" alt="GenLaravel Logo"
                            class="h-12 w-12 object-contain">
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-white flex items-center">
                            GenLaravel Multi-Page
                            <span
                                class="ml-3 px-3 py-1 bg-white bg-opacity-20 rounded-full text-xs font-semibold">BETA</span>
                        </h1>
                        <p class="text-sm text-white text-opacity-80">Generate Multiple Pages at Once</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="glass-effect px-4 py-2 rounded-lg limit-badge">
                        <i class="fas fa-bolt mr-2"></i>
                        <span id="daily-limit">5/5</span>
                        <span class="text-xs ml-2">generations left today</span>
                    </div>
                    <button onclick="window.location.href='/frontend/single/'"
                        class="glass-effect px-4 py-2 rounded-lg hover:bg-white hover:bg-opacity-20 transition">
                        <i class="fas fa-arrow-left mr-2"></i>Single Page Mode
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container mx-auto px-6 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

            <!-- Left Panel - Input & Control -->
            <div class="lg:col-span-1 space-y-6">
                <!-- Prompt Input Card -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-edit text-purple-500 mr-2"></i>
                        Multi-Page Prompt
                    </h2>

                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                Describe Your Multi-Page Application
                            </label>
                            <textarea id="user-prompt" rows="6"
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-400 focus:border-transparent resize-none"
                                placeholder="Example: Create a chat application with login page and chat interface page..."></textarea>
                            <p class="text-xs text-gray-500 mt-2">
                                <i class="fas fa-info-circle mr-1"></i>
                                Tip: Mention specific pages you need (e.g., "login, dashboard, profile")
                            </p>
                        </div>

                        <button id="generate-btn"
                            class="w-full bg-gradient-to-r from-purple-600 to-purple-700 text-white py-3 rounded-lg font-semibold hover:from-purple-700 hover:to-purple-800 transition shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed">
                            <i class="fas fa-magic mr-2"></i>
                            Generate Multi-Page App
                        </button>

                        <button id="stop-btn"
                            class="w-full bg-red-600 text-white py-3 rounded-lg font-semibold hover:bg-red-700 transition shadow-lg hidden">
                            <i class="fas fa-stop mr-2"></i>
                            Stop Generation
                        </button>
                    </div>
                </div>

                <!-- Statistics Card -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">Statistics</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-600">Total Agents</span>
                            <span class="font-bold text-purple-700">10</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-600">Completed</span>
                            <span id="stat-completed" class="font-bold text-green-600">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-600">Failed</span>
                            <span id="stat-failed" class="font-bold text-red-500">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-600">Duration</span>
                            <span id="stat-duration" class="font-bold text-gray-600">0s</span>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">Quick Actions</h3>
                    <div class="space-y-2">
                        <button id="action-open-output"
                            class="w-full text-left px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center">
                            <i class="fas fa-folder-open text-purple-600 mr-3"></i>
                            <span>Open Output Folder</span>
                        </button>
                        <button id="action-preview-draft"
                            class="w-full text-left px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center">
                            <i class="fas fa-eye text-green-600 mr-3"></i>
                            <span>Preview All Pages</span>
                        </button>
                        <button id="action-download-laravel"
                            class="w-full text-left px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center">
                            <i class="fas fa-download text-indigo-600 mr-3"></i>
                            <span>Download Laravel Project</span>
                        </button>

                        <button id="action-validate"
                            class="w-full text-left px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center">
                            <i class="fas fa-check-circle text-green-600 mr-3"></i>
                            <span>Validate Multi-Page</span>
                        </button>
                        <button id="action-clear-output"
                            class="w-full text-left px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center">
                            <i class="fas fa-trash text-red-500 mr-3"></i>
                            <span>Clear Output</span>
                        </button>
                    </div>
                </div>

                <!-- Daily Limit Info -->
                <div
                    class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl shadow-lg p-6 border border-purple-200">
                    <h3 class="text-lg font-bold text-purple-800 mb-3 flex items-center">
                        <i class="fas fa-info-circle mr-2"></i>
                        Daily Limit
                    </h3>
                    <p class="text-sm text-purple-700 mb-3">
                        Multi-page generation is limited to <strong>5 generations per day</strong> to ensure optimal
                        performance.
                    </p>
                    <div class="bg-white rounded-lg p-3">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-xs text-gray-600">Today's Usage</span>
                            <span class="text-xs font-bold text-purple-600" id="usage-text">0/5</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div id="usage-bar" class="bg-gradient-to-r from-purple-500 to-purple-600 h-2 rounded-full"
                                style="width: 0%"></div>
                        </div>
                    </div>
                    <p class="text-xs text-gray-500 mt-3">
                        <i class="fas fa-clock mr-1"></i>
                        Resets daily at midnight
                    </p>
                </div>
            </div>

            <!-- Right Panel - Pages & Output -->
            <div class="lg:col-span-2 space-y-6">
                <!-- Progress Overview -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-xl font-bold text-gray-800 flex items-center">
                            <i class="fas fa-tasks text-purple-500 mr-2"></i>
                            Generation Progress
                        </h2>
                        <span id="progress-percentage" class="text-2xl font-bold text-purple-500">0%</span>
                    </div>

                    <div class="w-full bg-gray-200 rounded-full h-4 mb-4">
                        <div id="progress-bar"
                            class="progress-bar bg-gradient-to-r from-purple-600 to-purple-500 h-4 rounded-full"
                            style="width: 0%"></div>
                    </div>

                    <div class="flex items-center justify-between text-sm text-gray-600">
                        <span id="current-agent-text">Waiting to start...</span>
                        <span id="agent-counter">0/10</span>
                    </div>
                </div>

                <!-- Generated Pages Preview (Multi-Page Feature) -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-file-alt text-purple-500 mr-2"></i>
                        Generated Pages
                    </h2>

                    <div id="pages-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="text-center py-12 text-gray-400 col-span-2">
                            <i class="fas fa-inbox text-4xl mb-3"></i>
                            <p>No pages generated yet</p>
                        </div>
                    </div>
                </div>

                <!-- Agent Pipeline with Toggle View -->
                <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                    <!-- Header with Toggle -->
                    <div class="p-6 pb-4 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <h2 class="text-xl font-bold text-gray-800 flex items-center">
                                <i class="fas fa-robot text-purple-500 mr-2"></i>
                                Agent Pipeline
                            </h2>
                            <div class="flex items-center space-x-2 bg-gray-100 rounded-lg p-1">
                                <button id="view-pipeline-btn"
                                    class="px-4 py-2 rounded-md bg-white shadow-sm text-gray-700 font-medium transition">
                                    <i class="fas fa-list mr-2"></i>Pipeline
                                </button>
                                <button id="view-terminal-btn"
                                    class="px-4 py-2 rounded-md text-gray-600 font-medium transition hover:bg-gray-50">
                                    <i class="fas fa-terminal mr-2"></i>Terminal
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Pipeline View -->
                    <div id="pipeline-view" class="p-6">
                        <div id="agent-pipeline" class="space-y-3">
                            <!-- Agent cards will be dynamically inserted here -->
                        </div>
                    </div>

                    <!-- Terminal View (Hidden by default) -->
                    <div id="terminal-view" class="hidden">
                        <div class="bg-gray-800 px-6 py-3 flex items-center justify-between">
                            <div class="flex items-center space-x-2">
                                <div class="w-3 h-3 bg-red-500 rounded-full"></div>
                                <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                                <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                                <span class="ml-4 text-gray-300 font-semibold">Output Terminal</span>
                            </div>
                            <button id="clear-terminal" class="text-gray-400 hover:text-white transition">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>

                        <div id="terminal-output"
                            class="terminal-output text-green-400 p-6 h-96 overflow-y-auto scroll-smooth bg-gray-900">
                            <div class="text-gray-500">
                                <i class="fas fa-terminal mr-2"></i>
                                Ready to generate multi-page Laravel application...
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Draft Preview Modal -->
        <div id="draft-modal"
            class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
            <div class="bg-white rounded-2xl shadow-2xl w-full h-full max-w-[95vw] max-h-[95vh] flex flex-col">
                <!-- Modal Header -->
                <div class="flex items-center justify-between p-4 border-b border-gray-200 flex-shrink-0">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-file-code text-purple-500 text-lg"></i>
                        </div>
                        <div>
                            <h2 class="text-xl font-bold text-gray-800">Multi-Page Draft Preview</h2>
                            <p class="text-sm text-gray-500">Review all generated pages with tabs</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center space-x-2 bg-gray-100 rounded-lg p-1">
                            <button id="zoom-out" class="px-3 py-1 rounded hover:bg-white transition text-sm">
                                <i class="fas fa-search-minus"></i>
                            </button>
                            <span id="zoom-level" class="text-sm font-semibold text-gray-600 px-2">75%</span>
                            <button id="zoom-in" class="px-3 py-1 rounded hover:bg-white transition text-sm">
                                <i class="fas fa-search-plus"></i>
                            </button>
                            <button id="zoom-reset" class="px-3 py-1 rounded hover:bg-white transition text-sm">
                                <i class="fas fa-redo"></i>
                            </button>
                        </div>
                        <button id="close-modal" class="text-gray-400 hover:text-gray-600 transition">
                            <i class="fas fa-times text-2xl"></i>
                        </button>
                    </div>
                </div>

                <!-- Modal Body -->
                <div class="flex-1 overflow-hidden bg-gray-100 p-4">
                    <div id="iframe-container" style="transform-origin: top left;">
                        <iframe id="draft-iframe" class="w-full bg-white shadow-lg"
                            style="height: 100vh; border: none;"></iframe>
                    </div>
                </div>

                <!-- Modal Footer -->
                <div class="flex items-center justify-between p-4 border-t border-gray-200 bg-gray-50 flex-shrink-0">
                    <div class="text-sm text-gray-600">
                        <i class="fas fa-info-circle mr-2"></i>
                        Review all pages and choose to approve or request revisions
                    </div>
                    <div class="flex space-x-3">
                        <button id="revise-draft"
                            class="px-6 py-3 bg-yellow-500 text-white rounded-lg font-semibold hover:bg-yellow-600 transition shadow-lg hover:shadow-xl">
                            <i class="fas fa-edit mr-2"></i>Request Revision
                        </button>
                        <button id="approve-draft"
                            class="px-6 py-3 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition shadow-lg hover:shadow-xl">
                            <i class="fas fa-check mr-2"></i>Approve & Continue
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Revision Modal -->
        <div id="revision-modal"
            class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl">
                <!-- Modal Header -->
                <div class="flex items-center justify-between p-6 border-b border-gray-200">
                    <div class="flex items-center space-x-3">
                        <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-edit text-yellow-500 text-xl"></i>
                        </div>
                        <div>
                            <h2 class="text-2xl font-bold text-gray-800">Revise Your Prompt</h2>
                            <p class="text-sm text-gray-500">Edit your prompt to regenerate the draft</p>
                        </div>
                    </div>
                </div>

                <!-- Modal Body -->
                <div class="p-6">
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        <i class="fas fa-pencil-alt mr-2"></i>Updated Prompt
                    </label>
                    <textarea id="revision-prompt" rows="8"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent resize-none"
                        placeholder="Enter your revised prompt here..."></textarea>
                    <p class="text-xs text-gray-500 mt-2">
                        <i class="fas fa-info-circle mr-1"></i>
                        Describe what changes you want to see in the regenerated draft
                    </p>
                </div>

                <!-- Modal Footer -->
                <div class="flex items-center justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50">
                    <button id="cancel-revision"
                        class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition">
                        <i class="fas fa-times mr-2"></i>Cancel
                    </button>
                    <button id="submit-revision"
                        class="px-6 py-3 bg-yellow-500 text-white rounded-lg font-semibold hover:bg-yellow-600 transition shadow-lg hover:shadow-xl">
                        <i class="fas fa-paper-plane mr-2"></i>Submit Revision
                    </button>
                </div>
            </div>
        </div>

        <!-- Toast Notification Container -->
        <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2"></div>

        <!-- Info Modal -->
        <div id="info-modal"
            class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col">
                <div class="p-6 border-b border-gray-200 flex-shrink-0">
                    <div class="flex items-center space-x-3">
                        <div id="info-modal-icon"
                            class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-info-circle text-purple-500 text-xl"></i>
                        </div>
                        <div>
                            <h2 id="info-modal-title" class="text-xl font-bold text-gray-800">Information</h2>
                        </div>
                    </div>
                </div>
                <div class="p-6 overflow-y-auto flex-1">
                    <div id="info-modal-content" class="text-gray-600"></div>
                </div>
                <div class="p-6 border-t border-gray-200 bg-gray-50 flex justify-end space-x-3 flex-shrink-0">
                    <button id="info-modal-close"
                        class="px-6 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition">
                        Close
                    </button>
                </div>
            </div>
        </div>

        <!-- Completion Detail Modal -->
        <div id="completion-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
            <div class="bg-white rounded-xl shadow-2xl w-full max-w-5xl h-[85vh] flex flex-col">
                <!-- Modal Header -->
                <div class="px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-indigo-50 flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-check-circle text-purple-600 text-xl"></i>
                        </div>
                        <div>
                            <h2 class="text-lg font-bold text-gray-800">Multi-Page Generation Complete</h2>
                            <p class="text-xs text-gray-600">All pages generated successfully</p>
                        </div>
                    </div>
                    <button id="completion-modal-close" class="text-gray-400 hover:text-gray-600 transition">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>

                <!-- Modal Body - Split Layout -->
                <div class="flex-1 flex overflow-hidden">
                    <!-- Left: Preview with Page Tabs -->
                    <div class="w-1/2 bg-gray-100 p-4 overflow-hidden flex flex-col">
                        <div class="flex items-center justify-between mb-3">
                            <h3 class="font-semibold text-gray-800 text-sm flex items-center">
                                <i class="fas fa-eye text-purple-600 mr-2"></i>
                                Page Preview
                            </h3>
                            <div class="flex items-center space-x-1 bg-white rounded px-2 py-1">
                                <button id="preview-zoom-out" class="text-gray-600 hover:text-gray-800 px-1">
                                    <i class="fas fa-search-minus text-xs"></i>
                                </button>
                                <span id="preview-zoom-level" class="text-xs font-semibold text-gray-600 px-1">50%</span>
                                <button id="preview-zoom-in" class="text-gray-600 hover:text-gray-800 px-1">
                                    <i class="fas fa-search-plus text-xs"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Page Tabs -->
                        <div class="flex space-x-2 mb-3 overflow-x-auto" id="page-tabs">
                            <!-- Will be populated dynamically -->
                        </div>
                        
                        <div class="flex-1 bg-white rounded-lg shadow-inner overflow-auto">
                            <div id="preview-container" style="transform-origin: top left;">
                                <iframe id="completion-preview-iframe" class="w-full bg-white" style="height: 200vh; border: none;"></iframe>
                            </div>
                        </div>
                    </div>

                    <!-- Right: Details -->
                    <div class="w-1/2 p-6 overflow-y-auto">
                        <!-- Summary Stats -->
                        <div class="grid grid-cols-4 gap-2 mb-4">
                            <div class="bg-blue-50 rounded-lg p-3 text-center">
                                <i class="fas fa-clock text-blue-600 text-lg mb-1"></i>
                                <div class="text-xl font-bold text-blue-700" id="completion-duration">0s</div>
                                <div class="text-xs text-gray-600">Duration</div>
                            </div>
                            <div class="bg-green-50 rounded-lg p-3 text-center">
                                <i class="fas fa-robot text-green-600 text-lg mb-1"></i>
                                <div class="text-xl font-bold text-green-700" id="completion-agents">0</div>
                                <div class="text-xs text-gray-600">Agents</div>
                            </div>
                            <div class="bg-purple-50 rounded-lg p-3 text-center">
                                <i class="fas fa-file-alt text-purple-600 text-lg mb-1"></i>
                                <div class="text-xl font-bold text-purple-700" id="completion-pages">0</div>
                                <div class="text-xs text-gray-600">Pages</div>
                            </div>
                            <div class="bg-orange-50 rounded-lg p-3 text-center">
                                <i class="fas fa-puzzle-piece text-orange-600 text-lg mb-1"></i>
                                <div class="text-xl font-bold text-orange-700" id="completion-components">0</div>
                                <div class="text-xs text-gray-600">Components</div>
                            </div>
                        </div>

                        <!-- Project Info -->
                        <div class="bg-gray-50 rounded-lg p-4 mb-4">
                            <h3 class="font-semibold text-gray-800 text-sm mb-3 flex items-center">
                                <i class="fas fa-info-circle text-purple-600 mr-2"></i>
                                Project Information
                            </h3>
                            <div class="space-y-2 text-xs">
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Project Path:</span>
                                    <span class="font-mono text-purple-700">my-laravel/</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Framework:</span>
                                    <span class="font-semibold text-red-600">Laravel 10.x</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Template Engine:</span>
                                    <span class="font-semibold text-orange-600">Blade</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">CSS Framework:</span>
                                    <span class="font-semibold text-cyan-600">Tailwind CSS</span>
                                </div>
                            </div>
                        </div>

                        <!-- Generated Pages List -->
                        <div class="bg-gray-50 rounded-lg p-4 mb-4">
                            <h3 class="font-semibold text-gray-800 text-sm mb-3 flex items-center">
                                <i class="fas fa-file-alt text-purple-600 mr-2"></i>
                                Generated Pages
                            </h3>
                            <div class="space-y-1 text-xs max-h-32 overflow-y-auto" id="completion-page-list">
                                <!-- Will be populated dynamically -->
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-lg p-4">
                            <h3 class="font-semibold text-gray-800 text-sm mb-3 flex items-center">
                                <i class="fas fa-bolt text-yellow-600 mr-2"></i>
                                Quick Actions
                            </h3>
                            <div class="grid grid-cols-2 gap-2">
                                <button onclick="openOutputFolder()" class="flex items-center justify-center space-x-2 bg-white hover:bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 transition text-xs">
                                    <i class="fas fa-folder-open text-purple-600"></i>
                                    <span class="font-medium">Open Folder</span>
                                </button>
                                <button onclick="previewAllPages()" class="flex items-center justify-center space-x-2 bg-white hover:bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 transition text-xs">
                                    <i class="fas fa-external-link-alt text-green-600"></i>
                                    <span class="font-medium">Open in Browser</span>
                                </button>
                                <button onclick="downloadProject()" class="flex items-center justify-center space-x-2 bg-white hover:bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 transition text-xs">
                                    <i class="fas fa-download text-indigo-600"></i>
                                    <span class="font-medium">Download ZIP</span>
                                </button>
                                <button onclick="viewCode()" class="flex items-center justify-center space-x-2 bg-white hover:bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 transition text-xs">
                                    <i class="fas fa-code text-blue-600"></i>
                                    <span class="font-medium">View Code</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="bg-gray-800 text-white mt-12 py-6">
            <div class="container mx-auto px-6 text-center">
                <p class="text-gray-400">
                    <i class="fas fa-code mr-2"></i>
                    GenLaravel Multi-Page - Powered by AI Agents | Built with ‚ù§Ô∏è
                </p>
            </div>
        </footer>

        <script>
            // Agent Configuration (same as single page but for multi-page context)
            const agents = [
                { id: 'prompt-expander', name: 'Prompt Expander', icon: 'fa-expand-arrows-alt', description: 'Expanding user prompt...' },
                { id: 'draft-agent', name: 'Draft Agent', icon: 'fa-file-code', description: 'Generating HTML drafts...' },
                { id: 'prompt-planner', name: 'Prompt Planner', icon: 'fa-project-diagram', description: 'Planning components...' },
                { id: 'page-architect', name: 'Page Architect', icon: 'fa-drafting-compass', description: 'Designing layouts for all pages...' },
                { id: 'blade-generator', name: 'Blade Generator', icon: 'fa-layer-group', description: 'Generating shared layout...' },
                { id: 'route-generator', name: 'Route Generator', icon: 'fa-route', description: 'Generating routes for all pages...' },
                { id: 'validator-fixer', name: 'Validator & Auto-Fixer', icon: 'fa-check-circle', description: 'Validating, fixing, and optimizing...' }
            ];

            // State Management
            let currentAgentIndex = -1;
            let startTime = null;
            let timerInterval = null;
            let completedCount = 0;
            let failedCount = 0;
            let generatedPages = [];
            let dailyUsage = 0;
            const dailyLimit = 999; // Unlimited (was 5)

            // Initialize
            document.addEventListener('DOMContentLoaded', () => {
                initializeAgentPipeline();
                loadDailyUsage();
                updateUsageDisplay();
                updateClock();
                setInterval(updateClock, 1000);
                initializeToggleButtons();
                initializeModalHandlers();
            });

            // Initialize Agent Pipeline UI
            function initializeAgentPipeline() {
                const pipeline = document.getElementById('agent-pipeline');
                if (!pipeline) return; // Skip if element doesn't exist yet

                pipeline.innerHTML = agents.map((agent, index) => `
                <div id="agent-${agent.id}" class="agent-card bg-gray-50 rounded-lg p-4 border-l-4 border-gray-300">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center">
                                <i class="fas ${agent.icon} text-gray-500"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold text-gray-800">${index + 1}. ${agent.name}</h3>
                                <p class="text-sm text-gray-500">${agent.description}</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <i id="status-${agent.id}" class="fas fa-circle status-pending"></i>
                            <span id="time-${agent.id}" class="text-xs text-gray-400">--</span>
                        </div>
                    </div>
                    <div id="output-${agent.id}" class="mt-3 text-sm text-gray-600 hidden"></div>
                </div>
            `).join('');
            }

            // Update Clock
            function updateClock() {
                const now = new Date();
                const clockEl = document.getElementById('current-time');
                if (clockEl) {
                    clockEl.textContent = now.toLocaleTimeString();
                }
            }

            // Initialize Toggle Buttons
            function initializeToggleButtons() {
                const pipelineBtn = document.getElementById('view-pipeline-btn');
                const terminalBtn = document.getElementById('view-terminal-btn');
                const pipelineView = document.getElementById('pipeline-view');
                const terminalView = document.getElementById('terminal-view');

                if (!pipelineBtn || !terminalBtn) return; // Skip if elements don't exist

                pipelineBtn.addEventListener('click', () => {
                    pipelineView.classList.remove('hidden');
                    terminalView.classList.add('hidden');
                    pipelineBtn.classList.add('bg-white', 'shadow-sm', 'text-gray-700');
                    pipelineBtn.classList.remove('text-gray-600');
                    terminalBtn.classList.remove('bg-white', 'shadow-sm', 'text-gray-700');
                    terminalBtn.classList.add('text-gray-600');
                });

                terminalBtn.addEventListener('click', () => {
                    terminalView.classList.remove('hidden');
                    pipelineView.classList.add('hidden');
                    terminalBtn.classList.add('bg-white', 'shadow-sm', 'text-gray-700');
                    terminalBtn.classList.remove('text-gray-600');
                    pipelineBtn.classList.remove('bg-white', 'shadow-sm', 'text-gray-700');
                    pipelineBtn.classList.add('text-gray-600');
                });
            }

            // Load Daily Usage from localStorage
            function loadDailyUsage() {
                const today = new Date().toDateString();
                const stored = localStorage.getItem('genlaravel_multi_usage');

                if (stored) {
                    const data = JSON.parse(stored);
                    if (data.date === today) {
                        dailyUsage = data.count;
                    } else {
                        // New day, reset
                        dailyUsage = 0;
                        localStorage.setItem('genlaravel_multi_usage', JSON.stringify({ date: today, count: 0 }));
                    }
                } else {
                    localStorage.setItem('genlaravel_multi_usage', JSON.stringify({ date: today, count: 0 }));
                }
            }

            // Update Usage Display
            function updateUsageDisplay() {
                const remaining = dailyLimit - dailyUsage;
                document.getElementById('daily-limit').textContent = `${remaining}/${dailyLimit}`;
                document.getElementById('usage-text').textContent = `${dailyUsage}/${dailyLimit}`;

                const usagePercent = (dailyUsage / dailyLimit) * 100;
                document.getElementById('usage-bar').style.width = `${usagePercent}%`;

                // Disable button if limit reached
                const generateBtn = document.getElementById('generate-btn');
                if (dailyUsage >= dailyLimit) {
                    generateBtn.disabled = true;
                    generateBtn.innerHTML = '<i class="fas fa-ban mr-2"></i>Daily Limit Reached';
                }
            }

            // Increment Usage
            function incrementUsage() {
                dailyUsage++;
                const today = new Date().toDateString();
                localStorage.setItem('genlaravel_multi_usage', JSON.stringify({ date: today, count: dailyUsage }));
                updateUsageDisplay();
            }

            // Initialize Modal Handlers
            let currentZoom = 0.75; // Start at 75%

            function initializeModalHandlers() {
                const modal = document.getElementById('draft-modal');
                const closeBtn = document.getElementById('close-modal');
                const iframeContainer = document.getElementById('iframe-container');
                const zoomLevelSpan = document.getElementById('zoom-level');

                closeBtn.addEventListener('click', () => {
                    modal.classList.add('hidden');
                });

                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.classList.add('hidden');
                    }
                });

                modal.querySelector('.bg-white').addEventListener('click', (e) => {
                    e.stopPropagation();
                });

                // Zoom controls
                document.getElementById('zoom-in').addEventListener('click', () => {
                    currentZoom = Math.min(currentZoom + 0.1, 1.5);
                    updateZoom();
                });

                document.getElementById('zoom-out').addEventListener('click', () => {
                    currentZoom = Math.max(currentZoom - 0.1, 0.25);
                    updateZoom();
                });

                document.getElementById('zoom-reset').addEventListener('click', () => {
                    currentZoom = 0.75;
                    updateZoom();
                });

                function updateZoom() {
                    iframeContainer.style.transform = `scale(${currentZoom})`;
                    iframeContainer.style.width = `${100 / currentZoom}%`;
                    iframeContainer.style.height = `${100 / currentZoom}%`;
                    zoomLevelSpan.textContent = `${Math.round(currentZoom * 100)}%`;
                }

                // Set initial zoom
                updateZoom();

                // Revision Modal Handlers
                const revisionModal = document.getElementById('revision-modal');
                const cancelRevisionBtn = document.getElementById('cancel-revision');
                const submitRevisionBtn = document.getElementById('submit-revision');
                const revisionPromptTextarea = document.getElementById('revision-prompt');

                cancelRevisionBtn.addEventListener('click', () => {
                    revisionModal.classList.add('hidden');
                    addTerminalOutput(`<span class="text-gray-400">[REVISION]</span> Revision cancelled.`);
                });

                submitRevisionBtn.addEventListener('click', () => {
                    const revisedPrompt = revisionPromptTextarea.value.trim();

                    if (!revisedPrompt) {
                        showToast('Please enter a revised prompt', 'error');
                        return;
                    }

                    revisionModal.classList.add('hidden');
                    addTerminalOutput(`<span class="text-yellow-400">[CONFIRMATION]</span> Revision requested with new prompt.`);

                    // Reset all pages to 'generating' status (reset checkmarks to spinners)
                    generatedPages.forEach(page => {
                        page.status = 'generating';
                    });
                    updatePagesDisplay();
                    
                    // Reset agent pipeline
                    currentAgentIndex = -1;
                    completedCount = 0;
                    agents.forEach(agent => {
                        updateAgentStatus(agent.id, 'pending');
                    });
                    updateStatistics();

                    // Send revision request with revised prompt to backend
                    if (ws && ws.readyState === WebSocket.OPEN) {
                        ws.send(JSON.stringify({
                            action: 'revise',
                            revised_prompt: revisedPrompt
                        }));
                        addTerminalOutput(`<span class="text-purple-400">[WEBSOCKET]</span> Sent revision request to backend`);
                    }
                });

                // Close revision modal on background click
                revisionModal.addEventListener('click', (e) => {
                    if (e.target === revisionModal) {
                        revisionModal.classList.add('hidden');
                    }
                });

                revisionModal.querySelector('.bg-white').addEventListener('click', (e) => {
                    e.stopPropagation();
                });
            }

            // WebSocket connection
            let ws = null;
            let isGenerating = false;
            let laravelUrl = 'http://localhost:8000'; // Default, will be updated from backend response

            // Generate Button Handler
            document.getElementById('generate-btn').addEventListener('click', async () => {
                console.log('üîµ Generate button clicked!');
                const prompt = document.getElementById('user-prompt').value.trim();
                console.log('üìù Prompt:', prompt);

                if (!prompt) {
                    console.log('‚ùå No prompt entered');
                    showToast('Please enter a prompt!', 'warning');
                    return;
                }

                if (dailyUsage >= dailyLimit) {
                    console.log('‚ùå Daily limit reached');
                    showToast('Daily limit reached! Try again tomorrow.', 'error');
                    return;
                }

                // Check if backend is available
                console.log('üîç Checking backend health...');
                try {
                    const healthCheck = await fetch('http://localhost:8080/health');
                    console.log('‚úÖ Backend health check:', healthCheck.ok);
                    if (!healthCheck.ok) throw new Error('Backend not available');

                    console.log('üöÄ Starting WebSocket generation...');
                    startGenerationWithWebSocket(prompt);
                } catch (error) {
                    console.error('‚ùå Backend error:', error);
                    showInfoModal(
                        'Backend Not Running',
                        `
                    <div class="space-y-4">
                        <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                            <p class="text-yellow-700 font-semibold mb-2">
                                <i class="fas fa-exclamation-triangle mr-2"></i>
                                FastAPI Backend Required
                            </p>
                            <p class="text-sm text-yellow-600">The backend server is not running. Real-time generation requires the backend.</p>
                        </div>
                        
                        <div class="bg-blue-50 rounded-lg p-4">
                            <p class="text-sm font-semibold mb-2">
                                <i class="fas fa-terminal mr-2"></i>
                                Start the backend:
                            </p>
                            <code class="block bg-gray-800 text-green-400 px-4 py-2 rounded text-sm mb-2">
                                python run_server.py
                            </code>
                            <p class="text-xs text-gray-600">Server will run at http://localhost:8080</p>
                        </div>
                        
                        <div class="bg-gray-50 rounded-lg p-4">
                            <p class="text-sm font-semibold mb-2 text-red-600">
                                <i class="fas fa-exclamation-circle mr-1"></i>
                                Backend is required for generation
                            </p>
                            <p class="text-xs text-gray-600">No demo mode available. Please start the backend server.</p>
                        </div>
                    </div>
                    `,
                        'fa-server',
                        'red'
                    );
                }
            });

            // Start Generation with WebSocket
            function startGenerationWithWebSocket(prompt) {
                console.log('üåê startGenerationWithWebSocket called');

                if (isGenerating) {
                    console.log('‚ö†Ô∏è Already generating');
                    showToast('Generation already in progress', 'warning');
                    return;
                }

                // Increment usage
                incrementUsage();
                console.log('üìä Usage incremented:', dailyUsage);

                // Reset state
                currentAgentIndex = -1;
                completedCount = 0;
                failedCount = 0;
                generatedPages = [];
                startTime = Date.now();
                isGenerating = true;
                console.log('üîÑ State reset');

                // UI Updates
                document.getElementById('generate-btn').classList.add('hidden');
                document.getElementById('stop-btn').classList.remove('hidden');
                document.getElementById('terminal-output').innerHTML = '';
                document.getElementById('pages-container').innerHTML = '<div class="text-center py-12 text-gray-400 col-span-2"><i class="fas fa-spinner fa-spin text-4xl mb-3"></i><p>Detecting pages...</p></div>';
                console.log('üé® UI updated');

                addTerminalOutput(`<span class="text-purple-400">[SYSTEM]</span> Connecting to backend...`);

                // Connect to WebSocket - MULTI PAGE endpoint
                console.log('üîå Creating WebSocket connection...');
                ws = new WebSocket('ws://localhost:8080/ws/generate/multi');

                ws.onopen = () => {
                    console.log('‚úÖ WebSocket OPENED!');
                    addTerminalOutput(`<span class="text-green-400">[CONNECTED]</span> WebSocket connected`);
                    addTerminalOutput(`<span class="text-gray-400">[PROMPT]</span> ${prompt}`);
                    addTerminalOutput('');

                    // Send generation request
                    const payload = { prompt: prompt, mode: 'multi' };
                    console.log('üì§ Sending payload:', payload);
                    ws.send(JSON.stringify(payload));

                    // Start timer
                    timerInterval = setInterval(updateDuration, 100);
                    console.log('‚è±Ô∏è Timer started');
                };

                ws.onmessage = (event) => {
                    console.log('üì® Message received:', event.data);
                    const data = JSON.parse(event.data);
                    console.log('üì¶ Parsed data:', data);
                    handleWebSocketMessage(data);
                };

                ws.onerror = (error) => {
                    console.error('‚ùå WebSocket ERROR:', error);
                    addTerminalOutput(`<span class="text-red-400">[ERROR]</span> WebSocket error`);
                    stopGeneration();
                    showToast('Connection error. Please check backend.', 'error');
                };

                ws.onclose = (event) => {
                    console.log('üî¥ WebSocket CLOSED:', event.code, event.reason);
                    addTerminalOutput(`<span class="text-gray-400">[DISCONNECTED]</span> WebSocket closed`);
                    if (isGenerating) {
                        stopGeneration();
                    }
                };
            }

            // Handle WebSocket Messages
            function handleWebSocketMessage(data) {
                switch (data.type) {
                    case 'start':
                        addTerminalOutput(`<span class="text-purple-400">[START]</span> ${data.message}`);
                        break;

                    case 'output':
                        addTerminalOutput(`<span class="text-gray-400">[INFO]</span> ${data.message}`);

                        // Detect page draft completion from output messages
                        // Pattern: "‚úÖ Saved: output/drafts/pagename.html"
                        const draftCompleteMatch = data.message.match(/‚úÖ Saved: output\/drafts\/(.+)\.html/);
                        if (draftCompleteMatch) {
                            const pageName = draftCompleteMatch[1];
                            const pageIndex = generatedPages.findIndex(p => p.name === pageName);
                            if (pageIndex !== -1) {
                                generatedPages[pageIndex].status = 'generated';
                                updatePagesDisplay();
                            }
                        }
                        break;

                    case 'agent_start':
                        // Find agent index
                        const startAgentIndex = agents.findIndex(a => a.id === data.agent_id);
                        if (startAgentIndex !== -1) {
                            currentAgentIndex = startAgentIndex;
                            updateAgentStatus(data.agent_id, 'running');
                            updateProgress();
                            completedCount = startAgentIndex;
                            updateStatistics();
                            addTerminalOutput(`<span class="text-purple-400">[${data.agent_name.toUpperCase()}]</span> ${data.description}`);
                        }
                        break;

                    case 'agent_complete':
                        if (currentAgentIndex !== -1) {
                            updateAgentStatus(data.agent_id, 'success', data.duration);
                            completedCount++;
                            updateStatistics();
                            addTerminalOutput(`<span class="text-green-400">[${data.agent_name.toUpperCase()}]</span> ‚úì Completed in ${data.duration}s`);
                            addTerminalOutput('');
                        }
                        break;

                    case 'pages_detected':
                        const statPages = document.getElementById('stat-pages');
                        if (statPages) {
                            statPages.textContent = data.count;
                        }
                        // Initialize pages with 'generating' status
                        generatedPages = data.pages.map(p => ({
                            name: p.name,
                            route: `/${p.name}`,
                            status: 'generating',
                            description: p.description || ''
                        }));
                        updatePagesDisplay();
                        addTerminalOutput(`<span class="text-blue-400">[INFO]</span> Detected ${data.count} pages`);
                        break;

                    case 'page_draft_complete':
                        // Update specific page status to 'generated'
                        const pageIndex = generatedPages.findIndex(p => p.name === data.page_name);
                        if (pageIndex !== -1) {
                            generatedPages[pageIndex].status = 'generated';
                            updatePagesDisplay();
                        }
                        addTerminalOutput(`<span class="text-green-400">[DRAFT]</span> ‚úÖ ${data.page_name} draft completed`);
                        break;

                    case 'draft_ready':
                        console.log('üì® Received draft_ready:', data);
                        addTerminalOutput(`<span class="text-yellow-400">[DRAFT]</span> ${data.message}`);
                        addTerminalOutput(`<span class="text-purple-400">[INFO]</span> Please review all pages and click Approve or Revise`);

                        updatePagesDisplay();

                        // Show modal for user confirmation
                        showDraftConfirmationWebSocket(data.draft_path);
                        break;

                    case 'complete':
                        addTerminalOutput('');
                        addTerminalOutput(`<span class="text-green-400 font-bold">[SUCCESS]</span> ‚úì ${data.message}`);
                        addTerminalOutput(`<span class="text-blue-400">[INFO]</span> Output: ${data.output_path}`);
                        if (data.pages_count) {
                            addTerminalOutput(`<span class="text-blue-400">[INFO]</span> Generated ${data.pages_count} pages`);
                        }

                        // Save Laravel URL from backend response
                        if (data.laravel_url) {
                            laravelUrl = data.laravel_url;
                            addTerminalOutput(`<span class="text-blue-400">[INFO]</span> Laravel URL: ${laravelUrl}`);
                        }

                        // Show pages list if available
                        if (data.pages && data.pages.length > 0) {
                            addTerminalOutput(`<span class="text-blue-400">[INFO]</span> Generated Pages:`);
                            data.pages.forEach(page => {
                                addTerminalOutput(`  ‚Ä¢ ${page.route} ‚Üí ${page.page}.blade.php`);
                            });
                        }

                        // Save generation info to localStorage
                        if (data.generation_info) {
                            localStorage.setItem('lastGeneration', JSON.stringify(data.generation_info));
                            addTerminalOutput(`<span class="text-blue-400">[INFO]</span> Generation info saved`);
                        }

                        addTerminalOutput('');
                        completeGeneration();
                        break;

                    case 'error':
                        addTerminalOutput(`<span class="text-red-400">[ERROR]</span> ${data.message}`);
                        showToast(data.message, 'error');
                        stopGeneration();
                        break;

                    case 'cancelled':
                        addTerminalOutput(`<span class="text-yellow-400">[CANCELLED]</span> ${data.message}`);
                        stopGeneration();
                        break;
                }
            }

            // Show Draft Confirmation for WebSocket
            function showDraftConfirmationWebSocket(draftPath) {
                const modal = document.getElementById('draft-modal');
                const iframe = document.getElementById('draft-iframe');

                // Load draft with cache busting
                iframe.src = 'http://localhost:8080' + draftPath + '?t=' + Date.now();
                modal.classList.remove('hidden');

                console.log('üìã Showing draft modal:', draftPath);

                // Remove old listeners if any
                const approveBtn = document.getElementById('approve-draft');
                const reviseBtn = document.getElementById('revise-draft');
                const closeBtn = document.getElementById('close-modal');

                // Clone buttons to remove old listeners
                const newApproveBtn = approveBtn.cloneNode(true);
                const newReviseBtn = reviseBtn.cloneNode(true);
                const newCloseBtn = closeBtn.cloneNode(true);

                approveBtn.parentNode.replaceChild(newApproveBtn, approveBtn);
                reviseBtn.parentNode.replaceChild(newReviseBtn, reviseBtn);
                closeBtn.parentNode.replaceChild(newCloseBtn, closeBtn);

                // Add new listeners
                newApproveBtn.addEventListener('click', () => {
                    modal.classList.add('hidden');
                    addTerminalOutput(`<span class="text-green-400">[CONFIRMATION]</span> Drafts approved. Continuing...`);

                    // Send approval to backend
                    if (ws && ws.readyState === WebSocket.OPEN) {
                        ws.send(JSON.stringify({ action: 'approve' }));
                        addTerminalOutput(`<span class="text-purple-400">[WEBSOCKET]</span> Sent approval to backend`);
                    }
                });

                newReviseBtn.addEventListener('click', () => {
                    modal.classList.add('hidden');

                    // Show revision modal
                    const revisionModal = document.getElementById('revision-modal');
                    const revisionPromptTextarea = document.getElementById('revision-prompt');
                    const promptInput = document.getElementById('user-prompt');

                    // Pre-fill with current prompt
                    if (promptInput) {
                        revisionPromptTextarea.value = promptInput.value;
                    }

                    revisionModal.classList.remove('hidden');
                    revisionPromptTextarea.focus();
                });

                newCloseBtn.addEventListener('click', () => {
                    modal.classList.add('hidden');
                    addTerminalOutput(`<span class="text-red-400">[CONFIRMATION]</span> Draft review cancelled.`);

                    if (ws && ws.readyState === WebSocket.OPEN) {
                        ws.send(JSON.stringify({ action: 'revise' }));
                    }
                });
            }

            // NO DEMO MODE - Only real WebSocket generation
            // (All demo functions removed)

            // Process Individual Phase
            async function processPhase(index) {
                currentPhaseIndex = index;
                const phase = phases[index];

                // Update UI
                updateProgress();
                addTerminalOutput(`<span class="text-purple-400">[${phase.name.toUpperCase()}]</span> ${phase.description}`);

                const phaseStartTime = Date.now();

                // Simulate phase processing
                await simulatePhaseWork(phase);

                const duration = ((Date.now() - phaseStartTime) / 1000).toFixed(2);

                addTerminalOutput(`<span class="text-green-400">[${phase.name.toUpperCase()}]</span> ‚úì Completed in ${duration}s`);
                addTerminalOutput('');

                // Update stats based on phase
                if (index === 0) {
                    // Page detection
                    const pageCount = Math.floor(Math.random() * 3) + 2; // 2-4 pages
                    document.getElementById('stat-pages').textContent = pageCount;
                    generatedPages = Array.from({ length: pageCount }, (_, i) => ({
                        name: `page-${i + 1}`,
                        route: `/page-${i + 1}`,
                        status: 'pending'
                    }));
                } else if (index === 1) {
                    // Draft generation
                    updatePagesDisplay();
                } else if (index === 2) {
                    // Component planning
                    document.getElementById('stat-components').textContent = Math.floor(Math.random() * 10) + 5;
                } else if (index === 5) {
                    // Route generation
                    document.getElementById('stat-routes').textContent = generatedPages.length;
                }
            }

            // Demo functions removed - only real WebSocket mode

            // Update Progress Bar
            function updateProgress() {
                // Use completedCount instead of currentAgentIndex for accurate progress
                const progress = (completedCount / agents.length) * 100;
                document.getElementById('progress-bar').style.width = `${progress}%`;
                document.getElementById('progress-percentage').textContent = `${Math.round(progress)}%`;
                if (currentAgentIndex >= 0 && currentAgentIndex < agents.length) {
                    document.getElementById('current-agent-text').textContent = agents[currentAgentIndex].description;
                    document.getElementById('agent-counter').textContent = `${currentAgentIndex + 1}/${agents.length}`;
                }
            }

            // Update Agent Status
            function updateAgentStatus(agentId, status, duration = 0) {
                const agentCard = document.getElementById(`agent-${agentId}`);
                if (!agentCard) return;

                const statusIcon = document.getElementById(`status-${agentId}`);
                const timeSpan = document.getElementById(`time-${agentId}`);

                // Update status icon
                statusIcon.className = `fas fa-circle status-${status}`;

                // Update time if completed
                if (duration > 0) {
                    timeSpan.textContent = `${duration}s`;
                }

                // Update card styling
                if (status === 'running') {
                    agentCard.className = 'agent-card bg-blue-50 rounded-lg p-4 border-l-4 border-blue-500';
                } else if (status === 'success') {
                    agentCard.className = 'agent-card bg-green-50 rounded-lg p-4 border-l-4 border-green-500';
                } else if (status === 'error') {
                    agentCard.className = 'agent-card bg-red-50 rounded-lg p-4 border-l-4 border-red-500';
                }
            }

            // Update Statistics
            function updateStatistics() {
                const completedEl = document.getElementById('stat-completed');
                const failedEl = document.getElementById('stat-failed');
                const durationEl = document.getElementById('stat-duration');

                if (completedEl) completedEl.textContent = completedCount;
                if (failedEl) failedEl.textContent = failedCount;

                if (durationEl && startTime) {
                    const duration = ((Date.now() - startTime) / 1000).toFixed(1);
                    durationEl.textContent = `${duration}s`;
                }
            }

            // Update Pages Display
            function updatePagesDisplay() {
                const container = document.getElementById('pages-container');
                container.innerHTML = generatedPages.map((page, index) => {
                    // Determine icon and color based on status
                    let statusIcon = '';
                    let statusColor = '';
                    let cardBg = '';

                    if (page.status === 'generated') {
                        statusIcon = '<i class="fas fa-check-circle text-green-500 text-xl"></i>';
                        cardBg = 'bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200';
                    } else if (page.status === 'generating') {
                        statusIcon = '<i class="fas fa-spinner fa-spin text-yellow-500 text-xl"></i>';
                        cardBg = 'bg-gradient-to-br from-gray-50 to-gray-100 border-gray-300';
                    } else {
                        statusIcon = '<i class="fas fa-clock text-gray-400 text-xl"></i>';
                        cardBg = 'bg-gradient-to-br from-gray-50 to-gray-100 border-gray-200';
                    }

                    return `
                    <div class="page-card ${cardBg} rounded-lg p-4 border">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center text-white font-bold">
                                    ${index + 1}
                                </div>
                                <div>
                                    <h3 class="font-semibold text-gray-800">${page.name}</h3>
                                    <p class="text-xs text-gray-500">${page.route}</p>
                                    ${page.description ? `<p class="text-xs text-gray-400 mt-1">${page.description}</p>` : ''}
                                </div>
                            </div>
                            ${statusIcon}
                        </div>
                        <button onclick="previewPage('${page.name}')" 
                            class="w-full bg-white text-purple-600 py-2 rounded-lg text-sm font-semibold hover:bg-purple-50 transition ${page.status !== 'generated' ? 'opacity-50 cursor-not-allowed' : ''}"
                            ${page.status !== 'generated' ? 'disabled' : ''}>
                            <i class="fas fa-eye mr-2"></i>Preview
                        </button>
                    </div>
                `;
                }).join('');
            }

            // Preview Page
            function previewPage(pageName) {
                addTerminalOutput(`<span class="text-blue-400">[PREVIEW]</span> Opening ${pageName}...`);
                // In real implementation, load the actual draft HTML
                const modal = document.getElementById('draft-modal');
                modal.classList.remove('hidden');
            }

            // Update Duration
            function updateDuration() {
                if (startTime) {
                    const duration = ((Date.now() - startTime) / 1000).toFixed(1);
                    document.getElementById('stat-duration').textContent = `${duration}s`;
                }
            }

            // Add Terminal Output
            function addTerminalOutput(text) {
                const terminal = document.getElementById('terminal-output');
                const line = document.createElement('div');
                line.innerHTML = text;
                line.classList.add('slide-in');
                terminal.appendChild(line);
                terminal.scrollTop = terminal.scrollHeight;
            }

            // Show Draft Confirmation
            async function showDraftConfirmation() {
                addTerminalOutput(`<span class="text-yellow-400">[CONFIRMATION]</span> All drafts generated. Please review.`);

                const modal = document.getElementById('draft-modal');
                modal.classList.remove('hidden');

                return new Promise((resolve) => {
                    const approveBtn = document.getElementById('approve-draft');
                    const reviseBtn = document.getElementById('revise-draft');
                    const closeBtn = document.getElementById('close-modal');

                    const handleApprove = () => {
                        modal.classList.add('hidden');
                        addTerminalOutput(`<span class="text-green-400">[CONFIRMATION]</span> Drafts approved. Continuing...`);
                        cleanup();
                        resolve(true);
                    };

                    const handleRevise = () => {
                        modal.classList.add('hidden');
                        addTerminalOutput(`<span class="text-yellow-400">[CONFIRMATION]</span> Revision requested.`);
                        cleanup();
                        resolve(false);
                    };

                    const handleClose = () => {
                        modal.classList.add('hidden');
                        cleanup();
                        resolve(false);
                    };

                    const cleanup = () => {
                        approveBtn.removeEventListener('click', handleApprove);
                        reviseBtn.removeEventListener('click', handleRevise);
                        closeBtn.removeEventListener('click', handleClose);
                    };

                    approveBtn.addEventListener('click', handleApprove);
                    reviseBtn.addEventListener('click', handleRevise);
                    closeBtn.addEventListener('click', handleClose);
                });
            }

            // Complete Generation
            function completeGeneration() {
                clearInterval(timerInterval);
                isGenerating = false;

                if (!document.getElementById('terminal-output').innerHTML.includes('[SUCCESS]')) {
                    addTerminalOutput('');
                    addTerminalOutput(`<span class="text-green-400 font-bold">[SUCCESS]</span> ‚úì Multi-page application generated!`);
                    addTerminalOutput(`<span class="text-blue-400">[INFO]</span> Total pages: ${generatedPages.length}`);
                    addTerminalOutput(`<span class="text-blue-400">[INFO]</span> Total duration: ${document.getElementById('stat-duration').textContent}`);
                    addTerminalOutput(`<span class="text-blue-400">[INFO]</span> Laravel project ready at: my-laravel/`);
                    addTerminalOutput('');
                }

                document.getElementById('stop-btn').classList.add('hidden');
                document.getElementById('generate-btn').classList.remove('hidden');

                updateProgress();

                // Close WebSocket if open
                if (ws && ws.readyState === WebSocket.OPEN) {
                    ws.close();
                }

                showToast('Multi-page generation completed!', 'success');
                
                // Show completion modal with details
                showCompletionModal();
            }

            // Show Completion Modal
            function showCompletionModal() {
                const modal = document.getElementById('completion-modal');
                const duration = document.getElementById('stat-duration').textContent;
                const agentsCompleted = completedCount;
                const pagesCount = generatedPages.length || 3;
                const componentsCount = pagesCount * 3; // Estimate
                
                // Update modal content
                document.getElementById('completion-duration').textContent = duration;
                document.getElementById('completion-agents').textContent = agentsCompleted;
                document.getElementById('completion-pages').textContent = pagesCount;
                document.getElementById('completion-components').textContent = componentsCount + '+';
                
                // Default pages if not tracked
                const pages = generatedPages.length > 0 ? generatedPages : [
                    { name: 'home', route: '/', file: 'home.html' },
                    { name: 'about', route: '/about', file: 'about.html' },
                    { name: 'contact', route: '/contact', file: 'contact.html' }
                ];
                
                // Generate page tabs
                const pageTabs = document.getElementById('page-tabs');
                pageTabs.innerHTML = pages.map((page, index) => `
                    <button onclick="switchPreviewPage('${page.file || page.name + '.html'}')" 
                        class="px-3 py-1 rounded text-xs font-medium transition ${index === 0 ? 'bg-purple-600 text-white' : 'bg-white text-gray-700 hover:bg-purple-50'}"
                        id="tab-${page.name}">
                        <i class="fas fa-file-code mr-1"></i>${page.name}
                    </button>
                `).join('');
                
                // Load first page preview - use same method as draft modal
                const previewIframe = document.getElementById('completion-preview-iframe');
                const draftFile = pages[0].file || pages[0].name + '.html';
                
                // Try drafts folder first
                let draftUrl = 'http://localhost:8080/output/drafts/' + draftFile + '?t=' + Date.now();
                console.log('Loading preview:', draftUrl);
                
                previewIframe.src = draftUrl;
                
                // Fallback to single draft.html on error
                previewIframe.addEventListener('error', function fallbackHandler() {
                    const fallbackUrl = 'http://localhost:8080/output/draft.html?t=' + Date.now();
                    console.log('Fallback to:', fallbackUrl);
                    previewIframe.src = fallbackUrl;
                    previewIframe.removeEventListener('error', fallbackHandler);
                }, { once: true });
                
                // Setup preview zoom controls
                let previewZoom = 0.5;
                const previewContainer = document.getElementById('preview-container');
                const previewZoomLevel = document.getElementById('preview-zoom-level');
                
                function updatePreviewZoom() {
                    previewContainer.style.transform = `scale(${previewZoom})`;
                    previewContainer.style.width = `${100 / previewZoom}%`;
                    previewContainer.style.height = `${100 / previewZoom}%`;
                    previewZoomLevel.textContent = `${Math.round(previewZoom * 100)}%`;
                }
                
                document.getElementById('preview-zoom-in').onclick = () => {
                    previewZoom = Math.min(previewZoom + 0.1, 1);
                    updatePreviewZoom();
                };
                
                document.getElementById('preview-zoom-out').onclick = () => {
                    previewZoom = Math.max(previewZoom - 0.1, 0.25);
                    updatePreviewZoom();
                };
                
                updatePreviewZoom();
                
                // Generate detailed page list
                const pageList = document.getElementById('completion-page-list');
                pageList.innerHTML = pages.map(page => `
                    <div class="flex items-center justify-between hover:bg-white px-2 py-1 rounded transition">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-file-code text-purple-600"></i>
                            <span class="font-mono">${page.name}.blade.php</span>
                        </div>
                        <span class="text-gray-400">${page.route}</span>
                    </div>
                `).join('');
                
                // Show modal
                modal.classList.remove('hidden');
                
                // Close button handler
                document.getElementById('completion-modal-close').onclick = () => {
                    modal.classList.add('hidden');
                };
                
                // Close on outside click
                modal.onclick = (e) => {
                    if (e.target === modal) {
                        modal.classList.add('hidden');
                    }
                };
            }

            // Switch preview page
            function switchPreviewPage(filename) {
                const previewIframe = document.getElementById('completion-preview-iframe');
                const draftUrl = 'http://localhost:8080/output/drafts/' + filename + '?t=' + Date.now();
                
                console.log('Switching to:', draftUrl);
                previewIframe.src = draftUrl;
                
                // Update tab styles
                document.querySelectorAll('#page-tabs button').forEach(btn => {
                    btn.classList.remove('bg-purple-600', 'text-white');
                    btn.classList.add('bg-white', 'text-gray-700');
                });
                event.target.closest('button').classList.add('bg-purple-600', 'text-white');
                event.target.closest('button').classList.remove('bg-white', 'text-gray-700');
            }

            // Helper functions for quick actions
            function openOutputFolder() {
                fetch('http://localhost:8080/api/open-folder', { method: 'POST' })
                    .then(() => showToast('Opening output folder...', 'info'))
                    .catch(() => showToast('Could not open folder', 'error'));
            }

            function previewAllPages() {
                document.getElementById('completion-modal').classList.add('hidden');
                document.getElementById('action-preview-draft').click();
            }

            function downloadProject() {
                showToast('Download feature coming soon', 'info');
            }

            function viewCode() {
                document.getElementById('completion-modal').classList.add('hidden');
                document.getElementById('action-open-output').click();
            }

            // Stop Generation
            function stopGeneration() {
                clearInterval(timerInterval);
                isGenerating = false;
                document.getElementById('stop-btn').classList.add('hidden');
                document.getElementById('generate-btn').classList.remove('hidden');

                // Close WebSocket if open
                if (ws && ws.readyState === WebSocket.OPEN) {
                    ws.close();
                }
            }

            // Clear Terminal
            document.getElementById('clear-terminal').addEventListener('click', () => {
                document.getElementById('terminal-output').innerHTML = '';
            });

            // Stop Button Handler
            document.getElementById('stop-btn').addEventListener('click', () => {
                addTerminalOutput(`<span class="text-red-400">[SYSTEM]</span> Generation stopped by user.`);
                stopGeneration();
            });

            // Utility Functions
            function sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }

            // Toast Notification System
            function showToast(message, type = 'info') {
                const container = document.getElementById('toast-container');
                const toast = document.createElement('div');

                const colors = {
                    success: 'bg-green-500',
                    error: 'bg-red-500',
                    warning: 'bg-yellow-500',
                    info: 'bg-purple-500'
                };

                const icons = {
                    success: 'fa-check-circle',
                    error: 'fa-exclamation-circle',
                    warning: 'fa-exclamation-triangle',
                    info: 'fa-info-circle'
                };

                toast.className = `toast ${colors[type]} text-white px-6 py-4 rounded-lg shadow-lg flex items-center space-x-3`;
                toast.innerHTML = `
                <i class="fas ${icons[type]} text-xl"></i>
                <span class="flex-1">${message}</span>
                <button onclick="this.parentElement.remove()" class="text-white hover:text-gray-200">
                    <i class="fas fa-times"></i>
                </button>
            `;

                container.appendChild(toast);

                // Auto remove after 5 seconds
                setTimeout(() => {
                    toast.classList.add('removing');
                    setTimeout(() => toast.remove(), 300);
                }, 5000);
            }

            // Info Modal System
            function showInfoModal(title, content, iconClass = 'fa-info-circle', iconColor = 'purple') {
                const modal = document.getElementById('info-modal');
                const titleEl = document.getElementById('info-modal-title');
                const contentEl = document.getElementById('info-modal-content');
                const iconEl = document.getElementById('info-modal-icon');

                titleEl.textContent = title;
                contentEl.innerHTML = content;
                iconEl.className = `w-12 h-12 bg-${iconColor}-100 rounded-lg flex items-center justify-center`;
                iconEl.innerHTML = `<i class="fas ${iconClass} text-${iconColor}-500 text-xl"></i>`;

                modal.classList.remove('hidden');
            }

            // Info Modal Close Handler
            document.getElementById('info-modal-close').addEventListener('click', () => {
                document.getElementById('info-modal').classList.add('hidden');
            });

            document.getElementById('info-modal').addEventListener('click', (e) => {
                if (e.target.id === 'info-modal') {
                    document.getElementById('info-modal').classList.add('hidden');
                }
            });

            // Quick Actions Handlers
            document.getElementById('action-open-output').addEventListener('click', () => {
                addTerminalOutput(`<span class="text-purple-400">[ACTION]</span> Opening output folder...`);

                // Get generation info from localStorage
                const lastGen = localStorage.getItem('lastGeneration');
                let genInfo = null;
                try {
                    genInfo = lastGen ? JSON.parse(lastGen) : null;
                } catch (e) {
                    console.error('Failed to parse generation info:', e);
                }

                let contentHtml = '';
                if (genInfo && genInfo.mode === 'multi') {
                    const timestamp = new Date(genInfo.timestamp).toLocaleString();
                    const componentsCount = genInfo.components_count || genInfo.components?.length || 0;
                    const pagesCount = genInfo.pages_count || genInfo.pages?.length || 0;

                    const pagesList = genInfo.pages?.map(p =>
                        `<li><i class="fas fa-file-code text-green-500 mr-2"></i>${p.page}.blade.php ‚Üí ${p.route}</li>`
                    ).join('') || '';

                    contentHtml = `
                <div class="space-y-3">
                    <div class="bg-purple-50 border-l-4 border-purple-500 p-3 rounded">
                        <p class="text-sm font-semibold text-purple-800">Last Multi-Page Generation</p>
                        <p class="text-xs text-purple-600">${timestamp}</p>
                        <p class="text-xs text-purple-600">${pagesCount} pages, ${componentsCount} components</p>
                    </div>
                    
                    <p class="font-semibold">Location: <code class="bg-gray-100 px-2 py-1 rounded">./output/</code></p>
                    
                    <!-- Grid layout for side-by-side display -->
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-gray-50 rounded-lg p-4">
                            <p class="text-sm font-semibold mb-2">Generated Pages:</p>
                            <ul class="text-sm space-y-1 max-h-60 overflow-y-auto">
                                ${pagesList}
                            </ul>
                        </div>
                        
                        <div class="bg-gray-50 rounded-lg p-4">
                            <p class="text-sm font-semibold mb-2">Components (${componentsCount}):</p>
                            <ul class="text-sm space-y-1 max-h-60 overflow-y-auto">
                                ${genInfo.components?.sort().map(name =>
                        `<li><i class="fas fa-puzzle-piece text-purple-400 mr-2"></i>${name}.blade.php</li>`
                    ).join('') || '<li class="text-gray-400">No components</li>'}
                            </ul>
                        </div>
                    </div>
                    
                    <!-- Other files below -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <p class="text-sm font-semibold mb-2">Other Files:</p>
                        <ul class="text-sm space-y-1">
                            <li><i class="fas fa-file text-gray-400 mr-2"></i>draft.html (main index)</li>
                            <li>
                                <details class="cursor-pointer">
                                    <summary class="hover:bg-gray-100 rounded px-2 py-1 -mx-2">
                                        <i class="fas fa-folder text-purple-500 mr-2"></i>layouts/
                                    </summary>
                                    <ul class="ml-8 mt-1 space-y-1 text-xs text-gray-600">
                                        <li><i class="fas fa-file text-gray-400 mr-2"></i>app.blade.php</li>
                                    </ul>
                                </details>
                            </li>
                            <!-- Files (alphabetically) -->
                            <li><i class="fas fa-file-code text-blue-500 mr-2"></i>draft.html</li>
                            <li><i class="fas fa-route text-red-500 mr-2"></i>web.php</li>
                        </ul>
                    </div>
                    
                    <div class="bg-green-50 rounded-lg p-3">
                        <p class="text-sm font-semibold text-green-800 mb-1">
                            <i class="fas fa-globe mr-2"></i>Laravel URL
                        </p>
                        <a href="${genInfo.laravel_url}" target="_blank" class="text-sm text-green-600 hover:underline">
                            ${genInfo.laravel_url}
                        </a>
                    </div>
                </div>
                `;
                } else {
                    contentHtml = `
                <div class="space-y-3">
                    <p class="font-semibold">Location: <code class="bg-gray-100 px-2 py-1 rounded">./output/</code></p>
                    <div class="bg-gray-50 rounded-lg p-4">
                        <p class="text-sm font-semibold mb-2">Multi-Page Structure:</p>
                        <ul class="text-sm space-y-1">
                            <li><i class="fas fa-file-code text-purple-500 mr-2"></i>draft.html (index with tabs)</li>
                            <li><i class="fas fa-folder text-blue-500 mr-2"></i>drafts/ (individual pages)</li>
                            <li><i class="fas fa-file-code text-green-500 mr-2"></i>*.blade.php files</li>
                            <li><i class="fas fa-folder text-yellow-500 mr-2"></i>components/</li>
                            <li><i class="fas fa-folder text-red-500 mr-2"></i>layouts/</li>
                        </ul>
                    </div>
                    <p class="text-sm text-gray-500">
                        <i class="fas fa-info-circle mr-1"></i>
                        Generate a multi-page app to see detailed info here.
                    </p>
                </div>
                `;
                }

                showInfoModal('Multi-Page Output', contentHtml, 'fa-folder-open', 'purple');
            });

            document.getElementById('action-preview-draft').addEventListener('click', () => {
                addTerminalOutput(`<span class="text-purple-400">[ACTION]</span> Opening multi-page draft preview...`);

                // Check if draft exists
                const draftPath = 'file://' + window.location.pathname.replace('frontend/multi-page.html', 'output/draft.html');

                // Show in modal
                const modal = document.getElementById('draft-modal');
                const iframe = document.getElementById('draft-iframe');
                iframe.src = draftPath;
                modal.classList.remove('hidden');

                showToast('Opening multi-page draft preview...', 'info');
            });

            document.getElementById('action-download-laravel').addEventListener('click', async () => {
                addTerminalOutput(`<span class="text-purple-400">[ACTION]</span> Downloading Laravel project...`);

                try {
                    const response = await fetch('http://localhost:8080/api/download/laravel');

                    if (!response.ok) {
                        throw new Error('Laravel project not found or backend not running');
                    }

                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;

                    const contentDisposition = response.headers.get('Content-Disposition');
                    const filename = contentDisposition
                        ? contentDisposition.split('filename=')[1].replace(/"/g, '')
                        : 'genlaravel-project.zip';

                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);

                    addTerminalOutput(`<span class="text-green-400">[SUCCESS]</span> Downloaded: ${filename}`);
                    showToast('Laravel project downloaded successfully!', 'success');
                } catch (error) {
                    addTerminalOutput(`<span class="text-red-400">[ERROR]</span> ${error.message}`);

                    showInfoModal(
                        'Download Laravel Project',
                        `
                    <div class="space-y-4">
                        <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                            <p class="text-yellow-700 font-semibold mb-2">
                                <i class="fas fa-exclamation-triangle mr-2"></i>
                                Backend Required
                            </p>
                            <p class="text-sm text-yellow-600">This feature requires the FastAPI backend to be running.</p>
                        </div>
                        
                        <div class="bg-blue-50 rounded-lg p-4">
                            <p class="text-sm font-semibold mb-2">
                                <i class="fas fa-terminal mr-2"></i>
                                To enable download:
                            </p>
                            <code class="block bg-gray-800 text-green-400 px-4 py-2 rounded text-sm mb-2">
                                python run_server.py
                            </code>
                            <p class="text-xs text-gray-600">Then try downloading again</p>
                        </div>
                        
                        <div class="bg-gray-50 rounded-lg p-4">
                            <p class="text-sm font-semibold mb-2">Alternative: Manual ZIP</p>
                            <p class="text-xs text-gray-600">You can manually zip the <code class="bg-gray-200 px-1 rounded">my-laravel/</code> folder</p>
                        </div>
                    </div>
                    `,
                        'fa-download',
                        'indigo'
                    );
                }
            });



            document.getElementById('action-validate').addEventListener('click', () => {
                addTerminalOutput(`<span class="text-purple-400">[ACTION]</span> Running multi-page validation...`);

                showInfoModal(
                    'Multi-Page Validation',
                    `
                <div class="space-y-4">
                    <div class="bg-purple-50 border-l-4 border-purple-500 p-4 rounded">
                        <p class="text-purple-700 font-semibold mb-2">
                            <i class="fas fa-check-circle mr-2"></i>
                            Comprehensive Validation
                        </p>
                        <p class="text-sm text-purple-600">Checks all aspects of your multi-page application.</p>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4">
                        <p class="text-sm font-semibold mb-2">Validation Checks:</p>
                        <ul class="text-sm space-y-1 text-gray-600">
                            <li><i class="fas fa-check text-green-500 mr-2"></i>Routes & components</li>
                            <li><i class="fas fa-check text-green-500 mr-2"></i>Blade syntax</li>
                            <li><i class="fas fa-check text-green-500 mr-2"></i>Nested UI issues</li>
                            <li><i class="fas fa-check text-green-500 mr-2"></i>Duplicate JavaScript</li>
                            <li><i class="fas fa-check text-green-500 mr-2"></i>CSS consistency</li>
                        </ul>
                    </div>
                    
                    <div class="bg-blue-50 rounded-lg p-4">
                        <p class="text-sm font-semibold mb-2">
                            <i class="fas fa-terminal mr-2"></i>
                            To run validation:
                        </p>
                        <code class="block bg-gray-800 text-green-400 px-4 py-2 rounded text-sm">
                            python validate_multi_page.py
                        </code>
                    </div>
                </div>
                `,
                    'fa-check-circle',
                    'green'
                );

                // Simulate validation in terminal
                addTerminalOutput(`<span class="text-blue-400">[INFO]</span> Checking routes, components, and blade syntax...`);
                setTimeout(() => {
                    addTerminalOutput(`<span class="text-green-400">[VALIDATION]</span> ‚úì Simulation complete!`);
                    addTerminalOutput(`<span class="text-blue-400">[INFO]</span> Run: python validate_multi_page.py for real validation`);
                    showToast('Validation info displayed', 'success');
                }, 1000);
            });

            document.getElementById('action-clear-output').addEventListener('click', () => {
                showInfoModal(
                    'Clear Output',
                    `
                <div class="space-y-4">
                    <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded">
                        <p class="text-red-700 font-semibold mb-2">
                            <i class="fas fa-exclamation-triangle mr-2"></i>
                            Warning: This action cannot be undone!
                        </p>
                        <p class="text-sm text-red-600">This will delete all generated files.</p>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4">
                        <p class="text-sm font-semibold mb-2">Will be deleted:</p>
                        <ul class="text-sm space-y-1 text-gray-600">
                            <li><i class="fas fa-folder text-red-500 mr-2"></i>output/ (all drafts)</li>
                            <li><i class="fas fa-folder text-red-500 mr-2"></i>my-laravel/resources/views/ (generated files)</li>
                        </ul>
                    </div>
                    
                    <div class="bg-blue-50 rounded-lg p-4">
                        <p class="text-sm font-semibold mb-2">
                            <i class="fas fa-terminal mr-2"></i>
                            To clear output, run:
                        </p>
                        <code class="block bg-gray-800 text-green-400 px-4 py-2 rounded text-sm">
                            python utils/clean_project.py
                        </code>
                        <p class="text-xs text-gray-600 mt-2">Then choose option 4 (Everything)</p>
                    </div>
                </div>
                `,
                    'fa-trash',
                    'red'
                );

                addTerminalOutput(`<span class="text-yellow-400">[INFO]</span> To clear output, run: python utils/clean_project.py`);
            });
        </script>
</body>

</html>